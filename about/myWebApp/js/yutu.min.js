var birds=[{top:-3,left:0},{top:-1,left:-2.5},{top:-2,left:-7.2},{top:0,left:-12}];var monkeys=[{top:0,left:0},{top:0,left:-1.25},{top:0,left:-2.5},{top:0,left:-3.75},{top:0,left:-5},{top:0,left:-6.25},{top:0,left:-7.5},{top:0,left:-8.75},{top:0,left:-10}];var dis=[2,5];var wid=[0.5,1.5];$(function(){var d=$("#monkey");var b=$("#bird");var a=d.find("img")[0];var e=b.find("img")[0];var c=d.find(".monkey_box")[0];var f=b.find(".bird_box")[0];document.querySelector("body").addEventListener("touchmove",function(g){g.preventDefault()});updatePic(e,birds,200);updatePic(a,monkeys,500);updateBox(wid,dis);updateStick(c,f,50)});function updatePic(e,b,c){clearInterval(e.timer);var a=b.length;var d=0;e.timer=setInterval(function(){$(e).css({top:b[d].top+"rem",left:b[d].left+"rem"});d++;if(d>=a){d=0}},c)}function movePic(e,a){clearInterval(e.newTimer);var d=$(e).offset().left;var c=$(e).outerWidth();var b=0;e.newTimer=setInterval(function(){$(e).css({left:d+b+"px"});b+=a/10;if(b>=a){clearInterval(e.newTimer)}},200)}function updateBox(a,f){var e=document.getElementById("box");var b=e.getElementsByTagName("div");var d=[];var g=[];d.push(randomNum(a),randomNum(a));g.push(0,randomNum(f));for(var c=0;c<2;c++){$(b[c]).css({width:d[c]+"rem",left:g[c]+"rem"})}}function updateStick(d,g,a){var c=0;var f=$("#stick");var b=f[0];var e=$("#box").find("div").eq(0).outerWidth();f.css({width:4+"px",left:e-4+"px"});$(document).bind("touchstart",function(h){b.timer=setInterval(function(){f.css({height:c+"px"});c+=a/20},100);h.preventDefault()}).bind("mouseup",function(){clearInterval(b.timer)}).bind("touchend",function(){clearInterval(b.timer);$(document).unbind("touchstart");$(document).unbind("mousedown");rotateStick(d,g,b);$(document).unbind("mouseup");$(document).unbind("touchend")})}function rotateStick(k,i,e){var a=$(e);var b=$(k).outerWidth();var d=b-$("#box>div").eq(0).outerWidth()/2;var f=a.outerHeight();var j=a.outerWidth();var c=f-j/2+b/2-d/2;a.css({"-webkit-transform":"rotateZ(90deg)",transition:"0.1s","-webkit-transform-origin":"center bottom 0"});movePic(k,c);var g=isSafe(f-j/2);if(g.flag){movePic(i,c);setTimeout(function(){window.location.href="success.html"},2000)}else{moveBird(i,g.w1+f-j/2,g.t1);setTimeout(function(){window.location.href="fail.html"},2500)}}function isSafe(a){var f=$("#box");var g=f.find("div").eq(0);var e=f.find("div").eq(1);var d=g.outerWidth();var h=g.offset().top;var c=e.offset().left;var b=e.outerWidth();return{flag:(a>c-d)&&(a<c-d+b)?true:false,w1:d,t1:h}}function moveBird(c,k,h){var e=0;var j=0;var d=$(c);var b=$("#bird");var g=b.offset().top;var a=h-g-b.outerHeight()/2;console.log(g);console.log(h);console.log("!!!!!!!!!!!!!!!");console.log(a);console.log(k);i(f);function i(l){setTimeout(function(){j+=5;e+=5;b.css({top:e});d.css({left:j});if(e<a&&j<k){setTimeout(arguments.callee,50)}else{l(j,e)}},30)}function f(l,m){var n=$("#bird").find("img")[0];if(l<k){setTimeout(function(){l+=1;d.css({left:l});if(l<k){setTimeout(arguments.callee,10)}},20)}else{setTimeout(function(){m+=1;b.css({top:m});if(m<a){setTimeout(arguments.callee,10)}},20)}clearInterval(n.timer);updatePic(n,birds,350)}}function randomNum(a){return Math.random()*(a[1]-a[0])+a[0]};